# 资源追踪页面地图修复说明

## 问题描述
资源追踪页面的资源地理分布部分没有显示真正的地图，只是使用了占位符（placeholder）来显示统计信息。

## 问题原因
1. **缺少地图组件**：`src/views/video-dispatch/resource-tracking.vue` 页面的地图部分只是静态占位符
2. **没有地图API集成**：页面没有集成高德地图或其他地图服务
3. **缺少地图初始化逻辑**：没有地图相关的JavaScript代码

## 已修复的内容

### 1. 地图容器结构
- ✅ 替换了静态占位符为真正的地图容器
- ✅ 添加了地图加载状态显示
- ✅ 添加了地图控制按钮（刷新、图层控制）

### 2. 地图功能实现
- ✅ **高德地图集成**：支持真实地图显示（需要API密钥）
- ✅ **模拟地图备用**：当高德地图API不可用时，显示模拟地图
- ✅ **资源标记点**：在地图上显示监控点、移动设备、人员、设备等资源位置
- ✅ **地图控件**：添加了比例尺、工具栏、地图类型切换等控件

### 3. 地图配置
- **中心坐标**：济宁港 (116.5800°E, 35.3800°N)
- **默认缩放**：12级
- **地图样式**：标准样式
- **支持功能**：背景、道路、建筑、兴趣点

### 4. 资源标记点
- **监控点**：蓝色圆形标记，显示监控摄像头位置
- **移动设备**：绿色圆形标记，显示移动巡查设备位置
- **人员资源**：紫色圆形标记，显示人员小组位置
- **设备资源**：橙色圆形标记，显示设备位置

### 5. 状态显示
- **在线状态**：绿色边框，表示资源正常工作
- **离线状态**：红色边框，表示资源不可用
- **警告状态**：橙色边框，表示资源需要关注

## 技术实现

### 地图初始化
```typescript
const initMap = () => {
  // 检查高德地图API是否可用
  if (typeof AMap === 'undefined') {
    initMockMap() // 使用模拟地图
    return
  }
  
  // 创建真实地图实例
  map.value = new AMap.Map(mapContainer.value, {
    zoom: mapConfig.zoom,
    center: mapConfig.center,
    mapStyle: mapConfig.style
  })
}
```

### 模拟地图
```typescript
const initMockMap = () => {
  // 创建网格线和资源点标记
  const mockMapContent = document.createElement('div')
  mockMapContent.className = 'mock-map-content'
  // 添加网格线和资源点
}
```

### 资源标记
```typescript
const initResourceMarkers = () => {
  // 添加监控点标记
  const cameraPoints = [
    { position: [116.5750, 35.3850], name: '主航道监控点A' },
    { position: [116.5850, 35.3750], name: '吴淞口监控点B' }
  ]
  
  cameraPoints.forEach(point => {
    const marker = new AMap.Marker({
      position: point.position,
      title: point.name,
      icon: customIcon
    })
  })
}
```

## 使用说明

### 1. 高德地图模式（推荐）
- 需要配置高德地图API密钥
- 显示真实地理环境和地图数据
- 支持缩放、平移、图层切换等操作

### 2. 模拟地图模式
- 完全离线运行，不依赖外部服务
- 显示网格线和资源点标记
- 支持鼠标悬停和点击交互

### 3. 地图控制
- **刷新地图**：重新加载地图数据和标记点
- **图层控制**：控制地图上显示的内容
- **状态统计**：显示各类资源的数量统计
- **图例说明**：说明不同颜色代表的含义

## 配置要求

### 高德地图API配置
1. 申请高德地图API密钥
2. 在环境变量中配置 `VITE_AMAP_API_KEY`
3. 或在HTML中直接引入高德地图脚本

### 模拟地图配置
- 无需额外配置
- 完全离线运行
- 支持自定义资源点位置

## 修复效果
1. **地图正常显示**：资源地理分布现在能正常显示地图
2. **资源可视化**：在地图上直观显示各类资源的位置分布
3. **交互体验**：支持地图操作和资源点查看
4. **双模式支持**：高德地图和模拟地图两种模式，确保可用性

## 注意事项
1. **API密钥**：使用高德地图需要有效的API密钥
2. **网络依赖**：高德地图需要网络连接
3. **性能优化**：大量资源点时需要考虑性能优化
4. **移动端适配**：地图在移动端的显示和操作需要特别优化

## 后续优化建议
1. **实时更新**：添加WebSocket支持，实现资源位置实时更新
2. **轨迹显示**：显示移动资源的运动轨迹
3. **热力图**：添加资源密度热力图显示
4. **搜索定位**：支持按资源名称或类型搜索定位
5. **统计分析**：在地图上显示资源分布统计信息
