import{i as e}from"./index-b344bc7d.js";import{d as a,f as t,r as l,c as s,o as i,n as o,V as n,W as r,a0 as u,k as c,$ as d,X as f,u as y,G as p,_ as g,a3 as m,F as v,a7 as h,a9 as b}from"./vendor-f41c3cc7.js";import{R as _}from"./icons-15893848.js";import{E as k}from"./antd-fa5730cf.js";import{_ as q}from"./index-3f839e27.js";const N={class:"quality-diagnosis"},w={class:"diagnosis-content"},D={class:"diagnosis-overview"},P={class:"overview-stats"},C={class:"quality-chart"},x={class:"diagnosis-list"},z={style:{"margin-left":"8px"}},S={key:0,class:"diagnosis-detail"},I={class:"issue-details"},A={class:"issue-suggestion"},j=q(a({__name:"quality-diagnosis",setup(a){const q=t(!1),j=t(!1),K=t(null),B=t();let J=null;const O=t([{id:1,cameraName:"码头1号",ip:"192.168.1.101",location:"码头前沿",status:"normal",quality:95,clarity:98,fluency:92,latency:150,resolution:"4K",fps:25,bitrate:8,snr:42,lastDiagnosis:"2025-08-26 10:30:00",issues:[]},{id:2,cameraName:"码头2号",ip:"192.168.1.102",location:"码头前沿",status:"warning",quality:78,clarity:85,fluency:70,latency:300,resolution:"1080P",fps:15,bitrate:4,snr:35,lastDiagnosis:"2025-08-26 10:30:00",issues:[{level:"medium",title:"帧率偏低",description:"当前帧率为15fps，低于标准25fps",suggestion:"检查网络带宽，调整编码参数"}]},{id:3,cameraName:"航道1号",ip:"192.168.1.103",location:"主航道",status:"error",quality:45,clarity:60,fluency:30,latency:800,resolution:"720P",fps:10,bitrate:2,snr:28,lastDiagnosis:"2025-08-26 10:30:00",issues:[{level:"high",title:"网络延迟过高",description:"网络延迟达到800ms，严重影响实时性",suggestion:"检查网络连接，优化网络配置"},{level:"high",title:"画面卡顿严重",description:"流畅性指标仅为30%，存在严重卡顿",suggestion:"检查设备性能，优化编码设置"}]},{id:4,cameraName:"锚地1号",ip:"192.168.1.104",location:"锚地区域",status:"offline",quality:0,clarity:0,fluency:0,latency:0,resolution:"N/A",fps:0,bitrate:0,snr:0,lastDiagnosis:"2025-08-26 10:30:00",issues:[{level:"high",title:"设备离线",description:"摄像头无法连接，网络中断",suggestion:"检查网络连接，重启设备"}]},{id:5,cameraName:"码头3号",ip:"192.168.1.105",location:"码头后方",status:"normal",quality:92,clarity:95,fluency:88,latency:180,resolution:"4K",fps:25,bitrate:8,snr:40,lastDiagnosis:"2025-08-26 10:28:00",issues:[]},{id:6,cameraName:"航道2号",ip:"192.168.1.106",location:"航道转弯处",status:"warning",quality:82,clarity:88,fluency:75,latency:250,resolution:"1080P",fps:20,bitrate:5,snr:38,lastDiagnosis:"2025-08-26 10:25:00",issues:[{level:"medium",title:"清晰度下降",description:"画面清晰度从95%降至88%，可能存在镜头污染",suggestion:"清洁镜头，检查摄像头防护罩"},{level:"low",title:"轻微色彩偏差",description:"画面色彩饱和度偏低，可能存在白平衡问题",suggestion:"调整白平衡参数，检查环境光线"}]},{id:7,cameraName:"锚地2号",ip:"192.168.1.107",location:"锚地中心",status:"error",quality:35,clarity:45,fluency:25,latency:1200,resolution:"720P",fps:8,bitrate:1.5,snr:22,lastDiagnosis:"2025-08-26 10:22:00",issues:[{level:"high",title:"严重网络丢包",description:"网络丢包率达到15%，导致画面严重失真",suggestion:"检查网络设备，更换网络线路"},{level:"high",title:"编码器故障",description:"H.264编码器工作异常，输出码率不稳定",suggestion:"重启编码器，检查固件版本"}]},{id:8,cameraName:"码头4号",ip:"192.168.1.108",location:"码头侧翼",status:"normal",quality:89,clarity:92,fluency:85,latency:200,resolution:"1080P",fps:25,bitrate:6,snr:39,lastDiagnosis:"2025-08-26 10:20:00",issues:[]},{id:9,cameraName:"航道3号",ip:"192.168.1.109",location:"航道入口",status:"warning",quality:76,clarity:82,fluency:68,latency:350,resolution:"1080P",fps:18,bitrate:4.5,snr:36,lastDiagnosis:"2025-08-26 10:18:00",issues:[{level:"medium",title:"带宽不足",description:"当前带宽占用率95%，影响视频传输质量",suggestion:"增加网络带宽，优化QoS设置"},{level:"low",title:"轻微画面抖动",description:"画面存在轻微抖动，可能受环境影响",suggestion:"检查设备安装稳定性，调整防抖参数"},{level:"low",title:"夜间噪点增加",description:"夜间模式下画面噪点明显增加",suggestion:"调整降噪参数，检查红外补光效果"}]},{id:10,cameraName:"锚地3号",ip:"192.168.1.110",location:"锚地边缘",status:"offline",quality:0,clarity:0,fluency:0,latency:0,resolution:"N/A",fps:0,bitrate:0,snr:0,lastDiagnosis:"2025-08-26 10:15:00",issues:[{level:"high",title:"电源故障",description:"设备电源指示灯熄灭，可能电源模块损坏",suggestion:"检查电源线路，更换电源模块"}]},{id:11,cameraName:"码头5号",ip:"192.168.1.111",location:"码头装卸区",status:"normal",quality:94,clarity:96,fluency:91,latency:160,resolution:"4K",fps:25,bitrate:8,snr:41,lastDiagnosis:"2025-08-26 10:12:00",issues:[]},{id:12,cameraName:"航道4号",ip:"192.168.1.112",location:"航道出口",status:"error",quality:28,clarity:35,fluency:20,latency:1500,resolution:"720P",fps:5,bitrate:1,snr:18,lastDiagnosis:"2025-08-26 10:10:00",issues:[{level:"high",title:"网络风暴",description:"检测到网络风暴，大量广播包影响正常通信",suggestion:"检查网络配置，隔离故障设备"},{level:"high",title:"存储空间不足",description:"本地存储空间仅剩5%，无法正常录制",suggestion:"清理历史数据，扩展存储空间"},{level:"medium",title:"温度过高",description:"设备温度达到75°C，超过正常工作范围",suggestion:"检查散热系统，改善通风条件"}]},{id:13,cameraName:"锚地4号",ip:"192.168.1.113",location:"锚地深水区",status:"warning",quality:71,clarity:78,fluency:65,latency:400,resolution:"1080P",fps:16,bitrate:3.5,snr:33,lastDiagnosis:"2025-08-26 10:08:00",issues:[{level:"medium",title:"信号衰减",description:"无线信号强度较弱，影响传输稳定性",suggestion:"调整天线角度，增加信号放大器"}]},{id:14,cameraName:"码头6号",ip:"192.168.1.114",location:"码头维修区",status:"normal",quality:91,clarity:94,fluency:87,latency:170,resolution:"1080P",fps:25,bitrate:6,snr:40,lastDiagnosis:"2025-08-26 10:05:00",issues:[]},{id:15,cameraName:"航道5号",ip:"192.168.1.115",location:"航道中段",status:"normal",quality:88,clarity:91,fluency:84,latency:190,resolution:"1080P",fps:22,bitrate:5.5,snr:37,lastDiagnosis:"2025-08-26 10:02:00",issues:[]},{id:16,cameraName:"锚地5号",ip:"192.168.1.116",location:"锚地浅水区",status:"error",quality:42,clarity:55,fluency:38,latency:900,resolution:"720P",fps:12,bitrate:2.5,snr:25,lastDiagnosis:"2025-08-26 10:00:00",issues:[{level:"high",title:"镜头起雾",description:"镜头表面起雾，严重影响画面清晰度",suggestion:"清洁镜头，检查密封性，更换防雾镜片"},{level:"medium",title:"对焦异常",description:"自动对焦功能失效，画面模糊",suggestion:"重启摄像头，检查对焦马达"},{level:"medium",title:"防水等级下降",description:"设备防护等级可能下降，存在进水风险",suggestion:"检查密封圈，更换防水配件"}]},{id:17,cameraName:"码头7号",ip:"192.168.1.117",location:"码头办公区",status:"warning",quality:79,clarity:85,fluency:72,latency:280,resolution:"1080P",fps:20,bitrate:4.8,snr:35,lastDiagnosis:"2025-08-26 09:58:00",issues:[{level:"medium",title:"光线不足",description:"夜间光线不足，红外补光效果不佳",suggestion:"调整补光角度，增加补光强度"}]},{id:18,cameraName:"航道6号",ip:"192.168.1.118",location:"航道转弯处",status:"normal",quality:93,clarity:95,fluency:90,latency:155,resolution:"4K",fps:25,bitrate:8,snr:41,lastDiagnosis:"2025-08-26 09:55:00",issues:[]},{id:19,cameraName:"锚地6号",ip:"192.168.1.119",location:"锚地入口",status:"offline",quality:0,clarity:0,fluency:0,latency:0,resolution:"N/A",fps:0,bitrate:0,snr:0,lastDiagnosis:"2025-08-26 09:52:00",issues:[{level:"high",title:"网络设备故障",description:"交换机端口异常，无法建立网络连接",suggestion:"检查交换机状态，更换故障端口"}]},{id:20,cameraName:"码头8号",ip:"192.168.1.120",location:"码头停车场",status:"normal",quality:90,clarity:93,fluency:86,latency:175,resolution:"1080P",fps:25,bitrate:6,snr:39,lastDiagnosis:"2025-08-26 09:50:00",issues:[]}]),Q=l({current:1,pageSize:6,total:0,showSizeChanger:!0,showQuickJumper:!0,showTotal:e=>`共 ${e} 条记录`}),R=[{title:"摄像头名称",dataIndex:"cameraName",key:"cameraName",ellipsis:!0,width:120},{title:"状态",dataIndex:"status",key:"status",ellipsis:!0,width:80},{title:"质量评分",dataIndex:"quality",key:"quality",ellipsis:!0,width:200},{title:"安装位置",dataIndex:"location",key:"location",ellipsis:!0},{title:"操作",key:"action",fixed:"right",ellipsis:!0}];s(()=>O.value.length);const T=s(()=>O.value.filter(e=>"normal"===e.status).length),X=s(()=>O.value.filter(e=>"warning"===e.status||"error"===e.status).length),$=s(()=>O.value.filter(e=>"offline"===e.status).length),E=e=>({normal:"green",warning:"orange",error:"red",offline:"default"}[e]||"default"),F=e=>({normal:"正常",warning:"警告",error:"异常",offline:"离线"}[e]||"未知"),G=e=>e>=90?"#52c41a":e>=70?"#faad14":"#ff4d4f",H=()=>{q.value=!0,setTimeout(()=>{q.value=!1,console.log("刷新诊断数据")},1e3)},M=()=>{console.log("导出诊断报告")},U=e=>{Q.current=e.current,Q.pageSize=e.pageSize};return i(()=>{console.log("视频质量诊断组件已挂载"),Q.total=O.value.length,o(()=>{(()=>{if(!B.value)return;J=e(B.value);const a={tooltip:{trigger:"item"},legend:{orient:"vertical",left:"left"},series:[{name:"摄像头状态",type:"pie",radius:"50%",data:[{value:T.value,name:"正常",itemStyle:{color:"#52c41a"}},{value:X.value,name:"异常",itemStyle:{color:"#ff4d4f"}},{value:$.value,name:"离线",itemStyle:{color:"#faad14"}}],emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]};J.setOption(a)})()})}),(e,a)=>{const t=f("a-statistic"),l=f("a-col"),s=f("a-row"),i=f("a-divider"),o=f("a-card"),J=f("a-button"),T=f("a-space"),X=f("a-tag"),$=f("a-progress"),V=f("a-table"),W=f("a-descriptions-item"),L=f("a-descriptions"),Y=f("a-avatar"),Z=f("a-list-item-meta"),ee=f("a-list-item"),ae=f("a-list"),te=f("a-modal");return n(),r("div",N,[a[7]||(a[7]=u("div",{class:"page-header"},[u("h2",null,"视频质量诊断"),u("p",null,"自动检测视频质量问题，包括清晰度、流畅性、延迟等指标，提供诊断报告和优化建议")],-1)),u("div",w,[u("div",D,[c(o,{title:"诊断概览",class:"overview-card"},{default:d(()=>[u("div",P,[c(s,{gutter:16},{default:d(()=>[c(l,{span:6},{default:d(()=>[c(t,{title:"总摄像头",value:70,"value-style":{color:"#1890ff"}})]),_:1}),c(l,{span:6},{default:d(()=>[c(t,{title:"正常",value:70,"value-style":{color:"#52c41a"}})]),_:1}),c(l,{span:6},{default:d(()=>[c(t,{title:"异常",value:0,"value-style":{color:"#ff4d4f"}})]),_:1}),c(l,{span:6},{default:d(()=>[c(t,{title:"离线",value:0,"value-style":{color:"#faad14"}})]),_:1})]),_:1})]),c(i),u("div",C,[u("div",{ref_key:"qualityChartRef",ref:B,style:{height:"200px"}},null,512)])]),_:1})]),u("div",x,[c(o,{title:"诊断详情",class:"diagnosis-list-card"},{extra:d(()=>[c(T,null,{default:d(()=>[c(J,{onClick:H},{icon:d(()=>[c(y(_))]),default:d(()=>[a[1]||(a[1]=p(" 刷新 ",-1))]),_:1}),c(J,{type:"primary",onClick:M},{default:d(()=>[...a[2]||(a[2]=[p(" 导出报告 ",-1)])]),_:1})]),_:1})]),default:d(()=>[c(V,{columns:R,"data-source":O.value,pagination:Q,loading:q.value,"row-key":"id",onChange:U},{bodyCell:d(({column:e,record:t})=>["status"===e.key?(n(),g(X,{key:0,color:E(t.status)},{default:d(()=>[p(m(F(t.status)),1)]),_:2},1032,["color"])):"quality"===e.key?(n(),r(v,{key:1},[c($,{percent:t.quality,"stroke-color":G(t.quality),"show-info":!1,size:"small"},null,8,["percent","stroke-color"]),u("span",z,m(t.quality)+"%",1)],64)):"action"===e.key?(n(),g(T,{key:2},{default:d(()=>[c(J,{size:"small",onClick:e=>(e=>{K.value=e,j.value=!0})(t)},{default:d(()=>[...a[3]||(a[3]=[p(" 详情 ",-1)])]),_:2},1032,["onClick"]),c(J,{size:"small",type:"primary",onClick:e=>(e=>{console.log("修复问题:",e.cameraName)})(t),disabled:"normal"===t.status},{default:d(()=>[...a[4]||(a[4]=[p(" 修复 ",-1)])]),_:2},1032,["onClick","disabled"])]),_:2},1024)):h("",!0)]),_:1},8,["data-source","pagination","loading"])]),_:1})])]),c(te,{open:j.value,"onUpdate:open":a[0]||(a[0]=e=>j.value=e),title:"诊断详情",width:"800px",footer:"{null}"},{default:d(()=>[K.value?(n(),r("div",S,[c(L,{title:"基本信息",column:2,bordered:""},{default:d(()=>[c(W,{label:"摄像头名称"},{default:d(()=>[p(m(K.value.cameraName),1)]),_:1}),c(W,{label:"IP地址"},{default:d(()=>[p(m(K.value.ip),1)]),_:1}),c(W,{label:"安装位置"},{default:d(()=>[p(m(K.value.location),1)]),_:1}),c(W,{label:"诊断状态"},{default:d(()=>[c(X,{color:E(K.value.status)},{default:d(()=>[p(m(F(K.value.status)),1)]),_:1},8,["color"])]),_:1})]),_:1}),c(i),c(L,{title:"质量指标",column:2,bordered:""},{default:d(()=>[c(W,{label:"整体质量"},{default:d(()=>[c($,{percent:K.value.quality,"stroke-color":G(K.value.quality)},null,8,["percent","stroke-color"])]),_:1}),c(W,{label:"清晰度"},{default:d(()=>[c($,{percent:K.value.clarity,"stroke-color":G(K.value.clarity)},null,8,["percent","stroke-color"])]),_:1}),c(W,{label:"流畅性"},{default:d(()=>[c($,{percent:K.value.fluency,"stroke-color":G(K.value.fluency)},null,8,["percent","stroke-color"])]),_:1}),c(W,{label:"延迟"},{default:d(()=>[c($,{percent:K.value.latency,"stroke-color":G(K.value.latency)},null,8,["percent","stroke-color"])]),_:1}),c(W,{label:"分辨率"},{default:d(()=>[c(X,{color:"blue"},{default:d(()=>[p(m(K.value.resolution),1)]),_:1})]),_:1}),c(W,{label:"帧率"},{default:d(()=>[c(X,{color:"green"},{default:d(()=>[p(m(K.value.fps>0?K.value.fps+"fps":"N/A"),1)]),_:1})]),_:1}),c(W,{label:"码率"},{default:d(()=>[c(X,{color:"purple"},{default:d(()=>[p(m(K.value.bitrate>0?K.value.bitrate+"Mbps":"N/A"),1)]),_:1})]),_:1}),c(W,{label:"信噪比"},{default:d(()=>[c(X,{color:"orange"},{default:d(()=>[p(m(K.value.snr>0?K.value.snr+"dB":"N/A"),1)]),_:1})]),_:1})]),_:1}),c(i),u("div",I,[a[6]||(a[6]=u("h4",null,"问题详情",-1)),c(ae,{"data-source":K.value.issues,"item-layout":"horizontal",size:"small"},{renderItem:d(({item:e})=>[c(ee,null,{default:d(()=>[c(Z,null,{avatar:d(()=>[c(Y,{style:b({backgroundColor:"high"===e.level?"#ff4d4f":"medium"===e.level?"#faad14":"#52c41a"})},{default:d(()=>[c(y(k))]),_:2},1032,["style"])]),title:d(()=>[u("span",{style:b({color:"high"===e.level?"#ff4d4f":"medium"===e.level?"#faad14":"#52c41a"})},m(e.title),5)]),description:d(()=>[u("div",null,m(e.description),1),u("div",A,[a[5]||(a[5]=u("strong",null,"建议:",-1)),p(" "+m(e.suggestion),1)])]),_:2},1024)]),_:2},1024)]),_:1},8,["data-source"])])])):h("",!0)]),_:1},8,["open"])])}}}),[["__scopeId","data-v-1eabc16a"]]);export{j as default};
