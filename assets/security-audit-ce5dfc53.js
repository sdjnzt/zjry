import{f as e,F as a,b as t,E as l,I as s,S as r,m as o}from"./antd-fa5730cf.js";import{i,r as u}from"./index-b344bc7d.js";import{d as n,f as c,r as d,c as m,o as v,n as f,V as p,W as y,a0 as g,k as h,$ as b,X as _,u as Y,G as M,_ as D,a3 as k,a7 as x,F as S,a1 as w,a8 as H}from"./vendor-f41c3cc7.js";import{W as C,U as T,R as z,E as U,B as O}from"./icons-15893848.js";import{_ as R}from"./index-43d4e559.js";const I={class:"security-audit"},E={class:"audit-overview"},q={class:"audit-content"},L={key:2,class:"user-info"},P={class:"user-name"},A={class:"user-role"},W={key:3,class:"operation-info"},K={class:"operation-name"},$={class:"operation-target"},B={key:5,class:"client-info"},G={class:"client-ip"},j={class:"client-location"},F={key:6,class:"timestamp-info"},J={class:"timestamp"},X={class:"duration"},Q={class:"real-time-alerts"},V={class:"alert-list"},N={class:"alert-header"},Z={class:"alert-level"},ee={class:"alert-time"},ae={class:"alert-message"},te={class:"online-users"},le={class:"user-list"},se={class:"user-avatar"},re={class:"user-details"},oe={class:"user-name"},ie={class:"user-status"},ue={class:"user-login-time"},ne={class:"user-location"},ce={class:"system-status"},de={class:"status-metrics"},me={class:"metric-item"},ve={class:"metric-value"},fe={class:"metric-item"},pe={class:"metric-value"},ye={class:"metric-item"},ge={class:"metric-value"},he={class:"audit-statistics"},be={class:"chart-container"},_e={class:"chart-container"},Ye={class:"chart-container"},Me={class:"chart-container"},De={class:"chart-container"},ke={class:"chart-container"},xe={key:0,class:"log-detail"},Se={class:"request-details"},we={class:"response-details"},He={key:0,class:"error-details"},Ce=R(n({__name:"security-audit",setup(n){const R=c(!1),Ce=c(!0),Te=c([]),ze=c("today"),Ue=c(null),Oe=c(!1),Re=c("operation"),Ie=c(),Ee=c(),qe=c(),Le=c(),Pe=c(),Ae=c(),We=c(),Ke=c(),$e=c(),Be=c(),Ge=c(),je=c(),Fe=d({level:"",category:""}),Je=d({visible:!1}),Xe=d({todayOperations:1247,securityEvents:3,accessCount:8956,abnormalLogins:2,totalLogs:15678,criticalEvents:8,warningEvents:45,errorEvents:23,successfulOperations:11890,failedOperations:788,uniqueUsers:89,uniqueIPs:156}),Qe=d({cpuUsage:45,memoryUsage:68,diskUsage:72}),Ve=d({current:1,pageSize:20,total:0,showSizeChanger:!0,showQuickJumper:!0,showTotal:e=>`共 ${e} 条记录`}),Ne=c([{id:"audit_001",level:"info",category:"login",user:"管理员",userRole:"系统管理员",operation:"用户登录",target:"管理控制台",success:!0,clientIp:"192.168.1.100",location:"上海市",timestamp:e().subtract(10,"minute").format("YYYY-MM-DD HH:mm:ss"),requestMethod:"POST",requestPath:"/api/auth/login",responseStatus:"200 OK",responseTime:156},{id:"audit_002",level:"warning",category:"access",user:"操作员A",userRole:"操作员",operation:"访问敏感资源",target:"港区A-摄像头01",success:!0,clientIp:"192.168.1.101",location:"北京市",timestamp:e().subtract(25,"minute").format("YYYY-MM-DD HH:mm:ss"),requestMethod:"GET",requestPath:"/api/resources/camera/001",responseStatus:"200 OK",responseTime:89},{id:"audit_003",level:"error",category:"operation",user:"未知用户",userRole:"未授权",operation:"尝试删除设备",target:"航道-传感器01",success:!1,clientIp:"203.156.78.92",location:"未知地区",timestamp:e().subtract(1,"hour").format("YYYY-MM-DD HH:mm:ss"),requestMethod:"DELETE",requestPath:"/api/devices/sensor/001",responseStatus:"403 Forbidden",responseTime:45,errorMessage:"权限不足",errorDetails:"用户没有删除设备的权限"},{id:"audit_004",level:"critical",category:"system",user:"系统",userRole:"系统",operation:"系统异常",target:"数据库连接",success:!1,clientIp:"127.0.0.1",location:"本地",timestamp:e().subtract(2,"hour").format("YYYY-MM-DD HH:mm:ss"),errorMessage:"数据库连接失败",errorDetails:"Connection timeout after 30 seconds"},{id:"audit_005",level:"info",category:"operation",user:"监控员B",userRole:"监控员",operation:"修改摄像头参数",target:"济宁港主码头-高清监控01",success:!0,clientIp:"192.168.1.102",location:"济宁市",timestamp:e().subtract(3,"hour").format("YYYY-MM-DD HH:mm:ss"),requestMethod:"PUT",requestPath:"/api/cameras/001/params",responseStatus:"200 OK",responseTime:234},{id:"audit_006",level:"warning",category:"access",user:"操作员C",userRole:"操作员",operation:"访问系统配置",target:"系统设置",success:!0,clientIp:"192.168.1.103",location:"济南市",timestamp:e().subtract(4,"hour").format("YYYY-MM-DD HH:mm:ss"),requestMethod:"GET",requestPath:"/api/system/config",responseStatus:"200 OK",responseTime:156},{id:"audit_007",level:"error",category:"operation",user:"维护员A",userRole:"维护员",operation:"重启设备",target:"济宁港-环境监测站",success:!1,clientIp:"192.168.1.104",location:"济宁市",timestamp:e().subtract(5,"hour").format("YYYY-MM-DD HH:mm:ss"),requestMethod:"POST",requestPath:"/api/devices/environment/restart",responseStatus:"500 Internal Server Error",responseTime:3e3,errorMessage:"设备重启失败",errorDetails:"设备当前状态不允许重启操作"},{id:"audit_008",level:"critical",category:"system",user:"系统",userRole:"系统",operation:"磁盘空间不足",target:"存储系统",success:!1,clientIp:"127.0.0.1",location:"本地",timestamp:e().subtract(6,"hour").format("YYYY-MM-DD HH:mm:ss"),errorMessage:"磁盘空间不足",errorDetails:"系统磁盘使用率超过90%，需要清理或扩容"},{id:"audit_009",level:"info",category:"login",user:"安全员A",userRole:"安全员",operation:"用户登录",target:"安全监控系统",success:!0,clientIp:"192.168.1.105",location:"青岛市",timestamp:e().subtract(7,"hour").format("YYYY-MM-DD HH:mm:ss"),requestMethod:"POST",requestPath:"/api/auth/login",responseStatus:"200 OK",responseTime:189},{id:"audit_010",level:"warning",category:"access",user:"未知用户",userRole:"未授权",operation:"尝试访问管理接口",target:"用户管理",success:!1,clientIp:"203.156.78.93",location:"未知地区",timestamp:e().subtract(8,"hour").format("YYYY-MM-DD HH:mm:ss"),requestMethod:"GET",requestPath:"/api/admin/users",responseStatus:"401 Unauthorized",responseTime:23,errorMessage:"未授权访问",errorDetails:"用户未登录或会话已过期"}]),Ze=c([{id:"alert_001",level:"critical",message:"检测到异常登录尝试",time:e().subtract(5,"minute").format("YYYY-MM-DD HH:mm:ss")},{id:"alert_002",level:"warning",message:"系统CPU使用率过高",time:e().subtract(15,"minute").format("YYYY-MM-DD HH:mm:ss")},{id:"alert_003",level:"info",message:"用户权限已更新",time:e().subtract(30,"minute").format("YYYY-MM-DD HH:mm:ss")},{id:"alert_004",level:"critical",message:"数据库连接异常",time:e().subtract(45,"minute").format("YYYY-MM-DD HH:mm:ss")},{id:"alert_005",level:"warning",message:"磁盘空间不足警告",time:e().subtract(1,"hour").format("YYYY-MM-DD HH:mm:ss")},{id:"alert_006",level:"info",message:"系统备份完成",time:e().subtract(2,"hour").format("YYYY-MM-DD HH:mm:ss")},{id:"alert_007",level:"critical",message:"网络连接中断",time:e().subtract(3,"hour").format("YYYY-MM-DD HH:mm:ss")},{id:"alert_008",level:"warning",message:"内存使用率过高",time:e().subtract(4,"hour").format("YYYY-MM-DD HH:mm:ss")}]),ea=c([{id:"user_001",name:"管理员",status:"活跃",loginTime:e().subtract(2,"hour").format("YYYY-MM-DD HH:mm:ss"),location:"上海市"},{id:"user_002",name:"操作员A",status:"在线",loginTime:e().subtract(1,"hour").format("YYYY-MM-DD HH:mm:ss"),location:"北京市"},{id:"user_003",name:"监控员B",status:"空闲",loginTime:e().subtract(30,"minute").format("YYYY-MM-DD HH:mm:ss"),location:"广州市"},{id:"user_004",name:"维护员A",status:"在线",loginTime:e().subtract(45,"minute").format("YYYY-MM-DD HH:mm:ss"),location:"济宁市"},{id:"user_005",name:"安全员A",status:"活跃",loginTime:e().subtract(1,"hour").format("YYYY-MM-DD HH:mm:ss"),location:"青岛市"},{id:"user_006",name:"操作员B",status:"空闲",loginTime:e().subtract(2,"hour").format("YYYY-MM-DD HH:mm:ss"),location:"济南市"},{id:"user_007",name:"监控员C",status:"在线",loginTime:e().subtract(30,"minute").format("YYYY-MM-DD HH:mm:ss"),location:"烟台市"},{id:"user_008",name:"维护员B",status:"活跃",loginTime:e().subtract(1,"hour").format("YYYY-MM-DD HH:mm:ss"),location:"潍坊市"}]),aa=m(()=>{let a=Ne.value;if(Fe.level&&(a=a.filter(e=>e.level===Fe.level)),Fe.category&&(a=a.filter(e=>e.category===Fe.category)),Te.value&&2===Te.value.length){const[t,l]=Te.value;a=a.filter(a=>{const s=e(a.timestamp);return s.isAfter(t)&&s.isBefore(l)})}return a}),ta=[{title:"级别",key:"level",width:80,fixed:"left"},{title:"类型",key:"category",width:100},{title:"用户",key:"user",width:120},{title:"操作",key:"operation",width:200},{title:"结果",key:"result",width:80},{title:"客户端",key:"clientInfo",width:150},{title:"时间",key:"timestamp",width:180},{title:"操作",key:"action",width:120,fixed:"right"}],la=e=>({info:"blue",warning:"orange",error:"red",critical:"red"}[e]||"default"),sa=e=>({info:"信息",warning:"警告",error:"错误",critical:"严重"}[e]||e),ra=e=>({login:"green",access:"blue",operation:"purple",system:"orange"}[e]||"default"),oa=e=>({login:"登录",access:"访问",operation:"操作",system:"系统"}[e]||e),ia=e=>e<50?"#52c41a":e<80?"#faad14":"#ff4d4f",ua=a=>e(a).format("YYYY-MM-DD HH:mm:ss"),na=a=>{const t=e(),l=e(a),s=t.diff(l,"minute");return s<60?`${s}分钟前`:s<1440?`${Math.floor(s/60)}小时前`:`${Math.floor(s/1440)}天前`},ca=()=>{console.log("日期范围变化:",Te.value)},da=()=>{console.log("过滤条件变化:",Fe)},ma=()=>{R.value=!0,setTimeout(()=>{R.value=!1,o.success("审计日志已刷新")},1e3)},va=()=>{o.success("审计日志导出成功")},fa=()=>{if(Ie.value){Oe.value=!0,We.value=i(Ie.value,null,{renderer:"canvas",useDirtyRect:!0}),u("custom",{color:["#1890ff","#52c41a","#faad14","#ff4d4f","#722ed1","#13c2c2","#eb2f96"]});const e={title:{text:"操作类型分布",left:"center",textStyle:{fontSize:16,fontWeight:"normal"}},tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} ({d}%)",backgroundColor:"rgba(255, 255, 255, 0.9)",borderColor:"#ccc",borderWidth:1,textStyle:{color:"#333"}},legend:{orient:"vertical",left:"left",top:"middle",textStyle:{color:"#666"}},series:[{name:"操作类型",type:"pie",radius:["40%","70%"],avoidLabelOverlap:!1,label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:"18",fontWeight:"bold"}},labelLine:{show:!1},animationType:"scale",animationEasing:"elasticOut",animationDelay:function(e){return 200*Math.random()},data:[{value:45,name:"登录操作",itemStyle:{color:"#52c41a"}},{value:30,name:"访问操作",itemStyle:{color:"#1890ff"}},{value:20,name:"系统操作",itemStyle:{color:"#faad14"}},{value:5,name:"其他操作",itemStyle:{color:"#722ed1"}}]}]};We.value.setOption(e),Oe.value=!1}},pa=e=>{f(()=>{switch(e){case"operation":We.value||fa();break;case"level":Ke.value||(()=>{if(Ee.value){Oe.value=!0,Ke.value=i(Ee.value,null,{renderer:"canvas",useDirtyRect:!0}),u("custom",{color:["#1890ff","#52c41a","#faad14","#ff4d4f","#722ed1","#13c2c2","#eb2f96"]});const e={title:{text:"日志级别趋势",left:"center",textStyle:{fontSize:16,fontWeight:"normal"}},tooltip:{trigger:"axis",backgroundColor:"rgba(255, 255, 255, 0.9)",borderColor:"#ccc",borderWidth:1,textStyle:{color:"#333"}},legend:{data:["信息","警告","错误","严重"],bottom:10,textStyle:{color:"#666"}},grid:{left:"3%",right:"4%",bottom:"15%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:["00:00","04:00","08:00","12:00","16:00","20:00","24:00"],axisLabel:{color:"#666"}},yAxis:{type:"value",axisLabel:{color:"#666"}},series:[{name:"信息",type:"line",stack:"Total",smooth:!0,animationDelay:function(e){return 100*e},data:[120,132,101,134,90,230,210],itemStyle:{color:"#1890ff"}},{name:"警告",type:"line",stack:"Total",smooth:!0,animationDelay:function(e){return 100*e},data:[220,182,191,234,290,330,310],itemStyle:{color:"#faad14"}},{name:"错误",type:"line",stack:"Total",smooth:!0,animationDelay:function(e){return 100*e},data:[150,232,201,154,190,330,410],itemStyle:{color:"#ff4d4f"}},{name:"严重",type:"line",stack:"Total",smooth:!0,animationDelay:function(e){return 100*e},data:[320,332,301,334,390,330,320],itemStyle:{color:"#cf1322"}}]};Ke.value.setOption(e),Oe.value=!1}})();break;case"user":$e.value||(()=>{if(qe.value){Oe.value=!0,$e.value=i(qe.value,null,{renderer:"canvas",useDirtyRect:!0}),u("custom",{color:["#1890ff","#52c41a","#faad14","#ff4d4f","#722ed1","#13c2c2","#eb2f96"]});const e={title:{text:"用户活跃度统计",left:"center",textStyle:{fontSize:16,fontWeight:"normal"}},tooltip:{trigger:"axis",axisPointer:{type:"shadow"},backgroundColor:"rgba(255, 255, 255, 0.9)",borderColor:"#ccc",borderWidth:1,textStyle:{color:"#333"}},grid:{left:"3%",right:"4%",bottom:"15%",containLabel:!0},xAxis:{type:"category",data:["管理员","操作员","监控员","维护员","安全员","其他"],axisLabel:{color:"#666"}},yAxis:{type:"value",axisLabel:{color:"#666"}},series:[{name:"活跃度",type:"bar",animationDelay:function(e){return 100*e},data:[{value:95,itemStyle:{color:"#52c41a"}},{value:78,itemStyle:{color:"#1890ff"}},{value:65,itemStyle:{color:"#faad14"}},{value:82,itemStyle:{color:"#722ed1"}},{value:88,itemStyle:{color:"#13c2c2"}},{value:45,itemStyle:{color:"#eb2f96"}}]}]};$e.value.setOption(e),Oe.value=!1}})();break;case"access":Be.value||(()=>{if(Le.value){Oe.value=!0,Be.value=i(Le.value,null,{renderer:"canvas",useDirtyRect:!0}),u("custom",{color:["#1890ff","#52c41a","#faad14","#ff4d4f","#722ed1","#13c2c2","#eb2f96"]});const e={title:{text:"访问趋势分析",left:"center",textStyle:{fontSize:16,fontWeight:"normal"}},tooltip:{trigger:"axis",backgroundColor:"rgba(255, 255, 255, 0.9)",borderColor:"#ccc",borderWidth:1,textStyle:{color:"#333"}},legend:{data:["访问次数","异常访问"],bottom:10,textStyle:{color:"#666"}},grid:{left:"3%",right:"4%",bottom:"15%",containLabel:!0},xAxis:{type:"category",data:["周一","周二","周三","周四","周五","周六","周日"],axisLabel:{color:"#666"}},yAxis:{type:"value",axisLabel:{color:"#666"}},series:[{name:"访问次数",type:"line",smooth:!0,animationDelay:function(e){return 100*e},data:[1200,1350,1100,1400,1600,800,600],itemStyle:{color:"#1890ff"}},{name:"异常访问",type:"line",smooth:!0,animationDelay:function(e){return 100*e},data:[15,23,18,25,30,12,8],itemStyle:{color:"#ff4d4f"}}]};Be.value.setOption(e),Oe.value=!1}})();break;case"security":Ge.value||(()=>{if(Pe.value){Oe.value=!0,Ge.value=i(Pe.value,null,{renderer:"canvas",useDirtyRect:!0}),u("custom",{color:["#1890ff","#52c41a","#faad14","#ff4d4f","#722ed1","#13c2c2","#eb2f96"]});const e={title:{text:"安全事件分析",left:"center",textStyle:{fontSize:16,fontWeight:"normal"}},tooltip:{trigger:"item",backgroundColor:"rgba(255, 255, 255, 0.9)",borderColor:"#ccc",borderWidth:1,textStyle:{color:"#333"}},legend:{orient:"vertical",left:"left",top:"middle",textStyle:{color:"#666"}},series:[{name:"安全事件",type:"pie",radius:"50%",animationType:"scale",animationEasing:"elasticOut",animationDelay:function(e){return 200*Math.random()},data:[{value:45,name:"异常登录",itemStyle:{color:"#ff4d4f"}},{value:30,name:"权限越界",itemStyle:{color:"#faad14"}},{value:15,name:"数据泄露",itemStyle:{color:"#cf1322"}},{value:10,name:"其他",itemStyle:{color:"#722ed1"}}],emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]};Ge.value.setOption(e),Oe.value=!1}})();break;case"location":je.value||(()=>{if(Ae.value){Oe.value=!0,je.value=i(Ae.value,null,{renderer:"canvas",useDirtyRect:!0}),u("custom",{color:["#1890ff","#52c41a","#faad14","#ff4d4f","#722ed1","#13c2c2","#eb2f96"]});const e={title:{text:"地理位置分布",left:"center",textStyle:{fontSize:16,fontWeight:"normal"}},tooltip:{trigger:"axis",axisPointer:{type:"shadow"},backgroundColor:"rgba(255, 255, 255, 0.9)",borderColor:"#ccc",borderWidth:1,textStyle:{color:"#333"}},legend:{data:["访问次数"],textStyle:{color:"#666"}},grid:{left:"3%",right:"4%",bottom:"15%",containLabel:!0},xAxis:{type:"category",data:["上海市","北京市","济宁市","济南市","青岛市","其他"],axisLabel:{color:"#666"}},yAxis:{type:"value",axisLabel:{color:"#666"}},series:[{name:"访问次数",type:"bar",smooth:!0,animationType:"scale",animationEasing:"elasticOut",animationDelay:function(e){return 100*e},data:[{value:320,itemStyle:{color:"#1890ff"}},{value:280,itemStyle:{color:"#52c41a"}},{value:250,itemStyle:{color:"#faad14"}},{value:200,itemStyle:{color:"#722ed1"}},{value:180,itemStyle:{color:"#13c2c2"}},{value:150,itemStyle:{color:"#eb2f96"}}]}]};je.value.setOption(e),Oe.value=!1}})()}})},ya=()=>{We.value&&console.log("更新图表数据，周期:",ze.value)};return v(()=>{Ve.total=Ne.value.length,console.log("安全审计日志页面已加载，共",Ne.value.length,"条日志记录"),f(()=>{fa()});const a=()=>{We.value&&We.value.resize(),Ke.value&&Ke.value.resize(),$e.value&&$e.value.resize(),Be.value&&Be.value.resize(),Ge.value&&Ge.value.resize(),je.value&&je.value.resize()};window.addEventListener("resize",a);const t=setInterval(()=>{if(Qe.cpuUsage=Math.floor(100*Math.random()),Qe.memoryUsage=Math.floor(100*Math.random()),Qe.diskUsage=Math.floor(100*Math.random()),Xe.todayOperations+=Math.floor(5*Math.random()),Xe.accessCount+=Math.floor(10*Math.random()),Math.random()>.7){const a={id:`alert_${Date.now()}`,level:Math.random()>.8?"critical":Math.random()>.6?"warning":"info",message:"系统运行正常",time:e().format("YYYY-MM-DD HH:mm:ss")};Ze.value.unshift(a),Ze.value.length>10&&Ze.value.pop()}},3e4);return()=>{clearInterval(t),window.removeEventListener("resize",a),We.value&&We.value.dispose(),Ke.value&&Ke.value.dispose(),$e.value&&$e.value.dispose(),Be.value&&Be.value.dispose(),Ge.value&&Ge.value.dispose(),je.value&&je.value.dispose()}}),(e,i)=>{const u=_("a-statistic"),n=_("a-card"),c=_("a-col"),d=_("a-row"),m=_("a-range-picker"),v=_("a-select-option"),f=_("a-select"),We=_("a-button"),Ke=_("a-space"),$e=_("a-tag"),Be=_("a-table"),Ge=_("a-badge"),je=_("a-progress"),Ne=_("a-radio-button"),fa=_("a-radio-group"),ga=_("a-spin"),ha=_("a-tab-pane"),ba=_("a-tabs"),_a=_("a-descriptions-item"),Ya=_("a-descriptions"),Ma=_("a-alert"),Da=_("a-modal");return p(),y("div",I,[i[33]||(i[33]=g("div",{class:"page-header"},[g("h2",null,"安全审计日志"),g("p",null,"完整的操作记录和追溯，确保系统安全和合规性")],-1)),g("div",E,[h(d,{gutter:16},{default:b(()=>[h(c,{span:6},{default:b(()=>[h(n,{class:"overview-card"},{default:b(()=>[h(u,{title:"今日操作",value:Xe.todayOperations,"value-style":{color:"#1890ff"}},{suffix:b(()=>[h(Y(a),{style:{color:"#1890ff","margin-left":"8px"}})]),_:1},8,["value"])]),_:1})]),_:1}),h(c,{span:6},{default:b(()=>[h(n,{class:"overview-card"},{default:b(()=>[h(u,{title:"安全事件",value:Xe.securityEvents,"value-style":{color:"#ff4d4f"}},{suffix:b(()=>[h(Y(C),{style:{color:"#ff4d4f","margin-left":"8px"}})]),_:1},8,["value"])]),_:1})]),_:1}),h(c,{span:6},{default:b(()=>[h(n,{class:"overview-card"},{default:b(()=>[h(u,{title:"访问次数",value:Xe.accessCount,"value-style":{color:"#52c41a"}},{suffix:b(()=>[h(Y(t),{style:{color:"#52c41a","margin-left":"8px"}})]),_:1},8,["value"])]),_:1})]),_:1}),h(c,{span:6},{default:b(()=>[h(n,{class:"overview-card"},{default:b(()=>[h(u,{title:"异常登录",value:Xe.abnormalLogins,"value-style":{color:"#faad14"}},{suffix:b(()=>[h(Y(l),{style:{color:"#faad14","margin-left":"8px"}})]),_:1},8,["value"])]),_:1})]),_:1})]),_:1}),h(d,{gutter:16,style:{"margin-top":"16px"}},{default:b(()=>[h(c,{span:6},{default:b(()=>[h(n,{class:"overview-card"},{default:b(()=>[h(u,{title:"严重事件",value:Xe.criticalEvents,"value-style":{color:"#cf1322"}},{suffix:b(()=>[h(Y(C),{style:{color:"#cf1322","margin-left":"8px"}})]),_:1},8,["value"])]),_:1})]),_:1}),h(c,{span:6},{default:b(()=>[h(n,{class:"overview-card"},{default:b(()=>[h(u,{title:"警告事件",value:Xe.warningEvents,"value-style":{color:"#d46b08"}},{suffix:b(()=>[h(Y(l),{style:{color:"#d46b08","margin-left":"8px"}})]),_:1},8,["value"])]),_:1})]),_:1}),h(c,{span:6},{default:b(()=>[h(n,{class:"overview-card"},{default:b(()=>[h(u,{title:"错误事件",value:Xe.errorEvents,"value-style":{color:"#a8071a"}},{suffix:b(()=>[h(Y(s),{style:{color:"#a8071a","margin-left":"8px"}})]),_:1},8,["value"])]),_:1})]),_:1}),h(c,{span:6},{default:b(()=>[h(n,{class:"overview-card"},{default:b(()=>[h(u,{title:"活跃用户",value:Xe.uniqueUsers,"value-style":{color:"#722ed1"}},{suffix:b(()=>[h(Y(T),{style:{color:"#722ed1","margin-left":"8px"}})]),_:1},8,["value"])]),_:1})]),_:1})]),_:1})]),g("div",q,[h(d,{gutter:16},{default:b(()=>[h(c,{span:18},{default:b(()=>[h(n,{title:"审计日志",class:"audit-log-card"},{extra:b(()=>[h(Ke,null,{default:b(()=>[h(m,{value:Te.value,"onUpdate:value":i[0]||(i[0]=e=>Te.value=e),"show-time":{format:"HH:mm:ss"},format:"YYYY-MM-DD HH:mm:ss",onChange:ca},null,8,["value"]),h(f,{value:Fe.level,"onUpdate:value":i[1]||(i[1]=e=>Fe.level=e),placeholder:"日志级别",style:{width:"120px"},onChange:da},{default:b(()=>[h(v,{value:""},{default:b(()=>[...i[6]||(i[6]=[M("全部级别",-1)])]),_:1}),h(v,{value:"info"},{default:b(()=>[...i[7]||(i[7]=[M("信息",-1)])]),_:1}),h(v,{value:"warning"},{default:b(()=>[...i[8]||(i[8]=[M("警告",-1)])]),_:1}),h(v,{value:"error"},{default:b(()=>[...i[9]||(i[9]=[M("错误",-1)])]),_:1}),h(v,{value:"critical"},{default:b(()=>[...i[10]||(i[10]=[M("严重",-1)])]),_:1})]),_:1},8,["value"]),h(f,{value:Fe.category,"onUpdate:value":i[2]||(i[2]=e=>Fe.category=e),placeholder:"操作类型",style:{width:"120px"},onChange:da},{default:b(()=>[h(v,{value:""},{default:b(()=>[...i[11]||(i[11]=[M("全部类型",-1)])]),_:1}),h(v,{value:"login"},{default:b(()=>[...i[12]||(i[12]=[M("登录",-1)])]),_:1}),h(v,{value:"access"},{default:b(()=>[...i[13]||(i[13]=[M("访问",-1)])]),_:1}),h(v,{value:"operation"},{default:b(()=>[...i[14]||(i[14]=[M("操作",-1)])]),_:1}),h(v,{value:"system"},{default:b(()=>[...i[15]||(i[15]=[M("系统",-1)])]),_:1})]),_:1},8,["value"]),h(We,{type:"primary",onClick:ma},{default:b(()=>[h(Y(z)),i[16]||(i[16]=M(" 刷新 ",-1))]),_:1}),h(We,{onClick:va},{default:b(()=>[h(Y(U)),i[17]||(i[17]=M(" 导出 ",-1))]),_:1})]),_:1})]),default:b(()=>[h(Be,{columns:ta,"data-source":aa.value,loading:R.value,pagination:Ve,"row-key":"id",size:"small",scroll:{x:1200}},{bodyCell:b(({column:e,record:a})=>["level"===e.key?(p(),D($e,{key:0,color:la(a.level)},{default:b(()=>[M(k(sa(a.level)),1)]),_:2},1032,["color"])):"category"===e.key?(p(),D($e,{key:1,color:ra(a.category)},{default:b(()=>[M(k(oa(a.category)),1)]),_:2},1032,["color"])):"user"===e.key?(p(),y("div",L,[g("div",P,k(a.user),1),g("div",A,k(a.userRole),1)])):"operation"===e.key?(p(),y("div",W,[g("div",K,k(a.operation),1),g("div",$,k(a.target),1)])):"result"===e.key?(p(),D($e,{key:4,color:a.success?"green":"red"},{default:b(()=>[M(k(a.success?"成功":"失败"),1)]),_:2},1032,["color"])):"clientInfo"===e.key?(p(),y("div",B,[g("div",G,k(a.clientIp),1),g("div",j,k(a.location),1)])):"timestamp"===e.key?(p(),y("div",F,[g("div",J,k(ua(a.timestamp)),1),g("div",X,k(na(a.timestamp)),1)])):"action"===e.key?(p(),D(Ke,{key:7},{default:b(()=>[h(We,{type:"link",size:"small",onClick:e=>{return t=a,Ue.value=t,void(Je.visible=!0);var t}},{default:b(()=>[h(Y(t)),i[18]||(i[18]=M(" 详情 ",-1))]),_:2},1032,["onClick"]),h(We,{type:"link",size:"small",onClick:e=>{return t=a,void o.info(`开始追踪操作: ${t.operation}`);var t}},{default:b(()=>[h(Y(r)),i[19]||(i[19]=M(" 追踪 ",-1))]),_:2},1032,["onClick"])]),_:2},1024)):x("",!0)]),_:1},8,["data-source","loading","pagination"])]),_:1})]),_:1}),h(c,{span:6},{default:b(()=>[h(n,{title:"实时监控",class:"monitor-card"},{extra:b(()=>[h(Ge,{dot:Ce.value},{default:b(()=>[h(Y(O),{style:{"font-size":"16px"}})]),_:1},8,["dot"])]),default:b(()=>[g("div",Q,[i[20]||(i[20]=g("h4",null,"实时告警",-1)),g("div",V,[(p(!0),y(S,null,w(Ze.value,e=>(p(),y("div",{key:e.id,class:H(["alert-item",`alert-${e.level}`])},[g("div",N,[g("div",Z,["critical"===e.level?(p(),D(Y(l),{key:0})):"warning"===e.level?(p(),D(Y(C),{key:1})):(p(),D(Y(s),{key:2}))]),g("div",ee,k(ua(e.time)),1)]),g("div",ae,k(e.message),1)],2))),128))])]),g("div",te,[i[21]||(i[21]=g("h4",null,"在线用户",-1)),g("div",le,[(p(!0),y(S,null,w(ea.value,e=>(p(),y("div",{key:e.id,class:"user-item"},[g("div",se,[h(Y(T))]),g("div",re,[g("div",oe,k(e.name),1),g("div",ie,k(e.status),1),g("div",ue,k(ua(e.loginTime)),1)]),g("div",ne,k(e.location),1)]))),128))])]),g("div",ce,[i[25]||(i[25]=g("h4",null,"系统状态",-1)),g("div",de,[g("div",me,[i[22]||(i[22]=g("span",{class:"metric-label"},"CPU使用率:",-1)),h(je,{percent:Qe.cpuUsage,"stroke-color":ia(Qe.cpuUsage),size:"small",style:{width:"80px"}},null,8,["percent","stroke-color"]),g("span",ve,k(Qe.cpuUsage)+"%",1)]),g("div",fe,[i[23]||(i[23]=g("span",{class:"metric-label"},"内存使用率:",-1)),h(je,{percent:Qe.memoryUsage,"stroke-color":ia(Qe.memoryUsage),size:"small",style:{width:"80px"}},null,8,["percent","stroke-color"]),g("span",pe,k(Qe.memoryUsage)+"%",1)]),g("div",ye,[i[24]||(i[24]=g("span",{class:"metric-label"},"磁盘使用率:",-1)),h(je,{percent:Qe.diskUsage,"stroke-color":ia(Qe.diskUsage),size:"small",style:{width:"80px"}},null,8,["percent","stroke-color"]),g("span",ge,k(Qe.diskUsage)+"%",1)])])])]),_:1})]),_:1})]),_:1})]),g("div",he,[h(n,{title:"审计统计",class:"statistics-card"},{extra:b(()=>[h(fa,{value:ze.value,"onUpdate:value":i[3]||(i[3]=e=>ze.value=e),size:"small",onChange:ya},{default:b(()=>[h(Ne,{value:"today"},{default:b(()=>[...i[26]||(i[26]=[M("今天",-1)])]),_:1}),h(Ne,{value:"week"},{default:b(()=>[...i[27]||(i[27]=[M("本周",-1)])]),_:1}),h(Ne,{value:"month"},{default:b(()=>[...i[28]||(i[28]=[M("本月",-1)])]),_:1}),h(Ne,{value:"year"},{default:b(()=>[...i[29]||(i[29]=[M("本年",-1)])]),_:1})]),_:1},8,["value"])]),default:b(()=>[h(ba,{activeKey:Re.value,"onUpdate:activeKey":i[4]||(i[4]=e=>Re.value=e),class:"chart-tabs",onChange:pa},{default:b(()=>[h(ha,{key:"operation",tab:"操作类型分布"},{default:b(()=>[g("div",be,[h(ga,{spinning:Oe.value,tip:"图表加载中..."},{default:b(()=>[g("div",{ref_key:"operationChartRef",ref:Ie,class:"chart-wrapper"},null,512)]),_:1},8,["spinning"])])]),_:1}),h(ha,{key:"level",tab:"日志级别趋势"},{default:b(()=>[g("div",_e,[h(ga,{spinning:Oe.value,tip:"图表加载中..."},{default:b(()=>[g("div",{ref_key:"levelChartRef",ref:Ee,class:"chart-wrapper"},null,512)]),_:1},8,["spinning"])])]),_:1}),h(ha,{key:"user",tab:"用户活跃度"},{default:b(()=>[g("div",Ye,[h(ga,{spinning:Oe.value,tip:"图表加载中..."},{default:b(()=>[g("div",{ref_key:"userChartRef",ref:qe,class:"chart-wrapper"},null,512)]),_:1},8,["spinning"])])]),_:1}),h(ha,{key:"access",tab:"访问趋势"},{default:b(()=>[g("div",Me,[h(ga,{spinning:Oe.value,tip:"图表加载中..."},{default:b(()=>[g("div",{ref_key:"accessChartRef",ref:Le,class:"chart-wrapper"},null,512)]),_:1},8,["spinning"])])]),_:1}),h(ha,{key:"security",tab:"安全事件分析"},{default:b(()=>[g("div",De,[h(ga,{spinning:Oe.value,tip:"图表加载中..."},{default:b(()=>[g("div",{ref_key:"securityChartRef",ref:Pe,class:"chart-wrapper"},null,512)]),_:1},8,["spinning"])])]),_:1}),h(ha,{key:"location",tab:"地理位置分布"},{default:b(()=>[g("div",ke,[h(ga,{spinning:Oe.value,tip:"图表加载中..."},{default:b(()=>[g("div",{ref_key:"locationChartRef",ref:Ae,class:"chart-wrapper"},null,512)]),_:1},8,["spinning"])])]),_:1})]),_:1},8,["activeKey"])]),_:1})]),h(Da,{open:Je.visible,"onUpdate:open":i[5]||(i[5]=e=>Je.visible=e),title:"日志详情",width:"800px",footer:null},{default:b(()=>[Ue.value?(p(),y("div",xe,[h(Ya,{column:2,bordered:""},{default:b(()=>[h(_a,{label:"日志ID"},{default:b(()=>[M(k(Ue.value.id),1)]),_:1}),h(_a,{label:"日志级别"},{default:b(()=>[h($e,{color:la(Ue.value.level)},{default:b(()=>[M(k(sa(Ue.value.level)),1)]),_:1},8,["color"])]),_:1}),h(_a,{label:"操作类型"},{default:b(()=>[h($e,{color:ra(Ue.value.category)},{default:b(()=>[M(k(oa(Ue.value.category)),1)]),_:1},8,["color"])]),_:1}),h(_a,{label:"执行结果"},{default:b(()=>[h($e,{color:Ue.value.success?"green":"red"},{default:b(()=>[M(k(Ue.value.success?"成功":"失败"),1)]),_:1},8,["color"])]),_:1}),h(_a,{label:"操作用户"},{default:b(()=>[M(k(Ue.value.user),1)]),_:1}),h(_a,{label:"用户角色"},{default:b(()=>[M(k(Ue.value.userRole),1)]),_:1}),h(_a,{label:"客户端IP"},{default:b(()=>[M(k(Ue.value.clientIp),1)]),_:1}),h(_a,{label:"地理位置"},{default:b(()=>[M(k(Ue.value.location),1)]),_:1}),h(_a,{label:"操作时间",span:2},{default:b(()=>[M(k(ua(Ue.value.timestamp)),1)]),_:1}),h(_a,{label:"操作描述",span:2},{default:b(()=>[M(k(Ue.value.operation),1)]),_:1}),h(_a,{label:"操作目标",span:2},{default:b(()=>[M(k(Ue.value.target),1)]),_:1})]),_:1}),g("div",Se,[i[30]||(i[30]=g("h4",null,"请求详情",-1)),h(Ya,{column:1,bordered:"",size:"small"},{default:b(()=>[h(_a,{label:"请求方法"},{default:b(()=>[M(k(Ue.value.requestMethod||"GET"),1)]),_:1}),h(_a,{label:"请求路径"},{default:b(()=>[M(k(Ue.value.requestPath||"/api/v1/resources"),1)]),_:1}),h(_a,{label:"用户代理"},{default:b(()=>[M(k(Ue.value.userAgent||"Mozilla/5.0..."),1)]),_:1}),h(_a,{label:"会话ID"},{default:b(()=>[M(k(Ue.value.sessionId||"sess_"+Ue.value.id),1)]),_:1})]),_:1})]),g("div",we,[i[31]||(i[31]=g("h4",null,"响应详情",-1)),h(Ya,{column:1,bordered:"",size:"small"},{default:b(()=>[h(_a,{label:"响应状态"},{default:b(()=>[M(k(Ue.value.responseStatus||"200 OK"),1)]),_:1}),h(_a,{label:"响应时间"},{default:b(()=>[M(k(Ue.value.responseTime||"125")+"ms ",1)]),_:1}),h(_a,{label:"数据大小"},{default:b(()=>[M(k(Ue.value.responseSize||"1024")+"字节 ",1)]),_:1})]),_:1})]),Ue.value.success?x("",!0):(p(),y("div",He,[i[32]||(i[32]=g("h4",null,"错误信息",-1)),h(Ma,{message:Ue.value.errorMessage||"操作失败",description:Ue.value.errorDetails||"具体错误详情信息",type:"error","show-icon":""},null,8,["message","description"])]))])):x("",!0)]),_:1},8,["open"])])}}}),[["__scopeId","data-v-34c0a388"]]);export{Ce as default};
