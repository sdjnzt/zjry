import{i as e}from"./index-b344bc7d.js";import{d as a,r as t,f as l,c as i,o as r,V as n,W as s,a0 as u,k as o,$ as d,X as c,G as v,a3 as p,a7 as m,_ as f}from"./vendor-f41c3cc7.js";import{m as y}from"./antd-fa5730cf.js";import{_ as g}from"./index-5905e6b1.js";import"./icons-15893848.js";const _={class:"communication-records"},h={class:"table-operations"},k={key:0},b={key:3},x={class:"chart-container"},C={class:"chart-container"},T={class:"chart-container"},w=g(a({__name:"communication-records",setup(a){const g=t({todayCommunications:456,successCommunications:432,failedCommunications:24,totalDuration:234.7,avgDuration:18.5,successRate:94.7,avgLatency:28,activeDevices:89}),w=t({communicationType:"",status:"",deviceName:"",timeRange:[]}),L=l(!1),M=l([]),O=l([{id:"COM001",name:"紧急情况通报",type:"voice",status:"success",priority:"high",initiator:"船舶A-监控设备",target:"通讯中心",startTime:"2025-08-26 10:30:00",endTime:"2025-08-26 10:45:00",duration:900,signalStrength:90,latency:35,packetLoss:.1,remark:"紧急情况处理"},{id:"COM002",name:"日常会议通讯",type:"video",status:"success",priority:"normal",initiator:"船舶B-通讯设备",target:"会议中心",startTime:"2025-08-26 09:15:00",endTime:"2025-08-26 09:45:00",duration:1800,signalStrength:85,latency:42,packetLoss:.3,remark:"日常工作安排"},{id:"COM003",name:"数据传输任务",type:"data",status:"failed",priority:"low",initiator:"船舶C-数据设备",target:"数据中心",startTime:"2025-08-26 08:00:00",endTime:"2025-08-26 08:05:00",duration:300,signalStrength:45,latency:120,packetLoss:5.2,remark:"网络不稳定"},{id:"COM004",name:"安全广播通知",type:"broadcast",status:"success",priority:"important",initiator:"广播中心",target:"全部区域",startTime:"2025-08-26 07:30:00",endTime:"2025-08-26 07:35:00",duration:300,signalStrength:95,latency:25,packetLoss:0,remark:"安全提醒"},{id:"COM005",name:"设备状态检查",type:"voice",status:"success",priority:"normal",initiator:"船舶D-监控设备",target:"监控中心",startTime:"2025-08-26 06:45:00",endTime:"2025-08-26 07:00:00",duration:900,signalStrength:88,latency:38,packetLoss:.2,remark:"例行检查"},{id:"COM006",name:"数据传输同步",type:"data",status:"success",priority:"normal",initiator:"船舶E-数据设备",target:"数据中心",startTime:"2025-08-26 06:00:00",endTime:"2025-08-26 06:15:00",duration:900,signalStrength:92,latency:32,packetLoss:.1,remark:"数据同步"},{id:"COM007",name:"紧急救援协调",type:"video",status:"success",priority:"urgent",initiator:"救援中心",target:"船舶F-通讯设备",startTime:"2025-08-26 05:30:00",endTime:"2025-08-26 05:45:00",duration:900,signalStrength:96,latency:28,packetLoss:0,remark:"紧急救援"},{id:"COM008",name:"航线规划会议",type:"video",status:"success",priority:"high",initiator:"船舶G-通讯设备",target:"调度中心",startTime:"2025-08-26 05:00:00",endTime:"2025-08-26 05:30:00",duration:1800,signalStrength:89,latency:35,packetLoss:.3,remark:"航线规划"},{id:"COM009",name:"设备维护通知",type:"broadcast",status:"success",priority:"normal",initiator:"维护中心",target:"维护区域",startTime:"2025-08-26 04:30:00",endTime:"2025-08-26 04:35:00",duration:300,signalStrength:94,latency:26,packetLoss:0,remark:"维护通知"},{id:"COM010",name:"天气信息更新",type:"data",status:"failed",priority:"low",initiator:"气象中心",target:"船舶H-数据设备",startTime:"2025-08-26 04:00:00",endTime:"2025-08-26 04:05:00",duration:300,signalStrength:52,latency:95,packetLoss:4.8,remark:"网络中断"},{id:"COM011",name:"安全培训通讯",type:"voice",status:"success",priority:"normal",initiator:"培训中心",target:"培训区域",startTime:"2025-08-26 03:30:00",endTime:"2025-08-26 04:00:00",duration:1800,signalStrength:91,latency:31,packetLoss:.2,remark:"安全培训"},{id:"COM012",name:"夜间巡逻报告",type:"voice",status:"success",priority:"routine",initiator:"巡逻队",target:"指挥中心",startTime:"2025-08-26 03:00:00",endTime:"2025-08-26 03:15:00",duration:900,signalStrength:87,latency:39,packetLoss:.4,remark:"巡逻报告"}]),S=[{title:"通讯ID",dataIndex:"id",key:"id",width:100},{title:"通讯名称",dataIndex:"name",key:"name",width:150},{title:"通讯类型",dataIndex:"type",key:"type",width:100},{title:"通讯状态",dataIndex:"status",key:"status",width:100},{title:"优先级",dataIndex:"priority",key:"priority",width:100},{title:"发起设备",dataIndex:"initiator",key:"initiator",width:150},{title:"目标设备",dataIndex:"target",key:"target",width:150},{title:"开始时间",dataIndex:"startTime",key:"startTime",width:150},{title:"通讯时长",dataIndex:"duration",key:"duration",width:100},{title:"操作",key:"action",width:200,fixed:"right"}],D=l([{type:"voice",count:189,percentage:41,color:"#1890ff"},{type:"video",count:134,percentage:29,color:"#52c41a"},{type:"data",count:89,percentage:20,color:"#fa8c16"},{type:"broadcast",count:44,percentage:10,color:"#722ed1"}]),I=l([{status:"success",count:432,percentage:95,color:"#52c41a"},{status:"failed",count:24,percentage:5,color:"#f5222d"}]),R=l([{date:"01-10",duration:18.5},{date:"01-11",duration:22.3},{date:"01-12",duration:19.8},{date:"01-13",duration:24.1},{date:"01-14",duration:21.3},{date:"01-15",duration:26.7}]);i(()=>Math.max(...R.value.map(e=>e.duration)));const $=l(!0),A=l(null),j=l(null),z=l(null),U=l(!1),N=l(null),W=i(()=>M.value.length>0),Y=e=>({success:"成功",failed:"失败",missed:"未接",cancelled:"已取消"}[e]||e),G=e=>({voice:"语音通话",video:"视频通话",data:"数据传输",broadcast:"广播"}[e]||e),H=e=>({low:"低",normal:"普通",high:"高",urgent:"紧急"}[e]||e),J=e=>{const a=Math.floor(e/3600),t=Math.floor(e%3600/60),l=e%60;return a>0?`${a}h ${t}m`:t>0?`${t}m ${l}s`:`${l}s`},B=()=>{L.value=!0,setTimeout(()=>{L.value=!1,y.success("搜索完成")},1e3)},E=()=>{Object.assign(w,{communicationType:"",status:"",deviceName:"",timeRange:[]}),y.info("搜索条件已重置")},F=()=>{y.success("数据导出功能")},K=()=>{L.value=!0,setTimeout(()=>{L.value=!1,y.success("记录已刷新")},1e3)},Q=()=>{y.success(`已删除 ${M.value.length} 条记录`),M.value=[]},V=e=>{M.value=e};r(()=>{console.log("通讯记录页面已加载"),X()});const X=()=>{$.value=!0,setTimeout(()=>{q(),P(),Z(),$.value=!1},500)},q=()=>{if(!A.value)return;const a=e(A.value),t={tooltip:{trigger:"axis"},legend:{data:["通讯次数"]},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:D.value.map(e=>G(e.type))},yAxis:{type:"value",axisLabel:{formatter:"{value} 次"}},series:[{name:"通讯次数",type:"bar",barWidth:"60%",data:D.value.map(e=>e.count)}]};a.setOption(t)},P=()=>{if(!j.value)return;const a=e(j.value),t={tooltip:{trigger:"axis"},legend:{data:["通讯次数"]},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:I.value.map(e=>Y(e.status))},yAxis:{type:"value",axisLabel:{formatter:"{value} 次"}},series:[{name:"通讯次数",type:"bar",barWidth:"60%",data:I.value.map(e=>e.count)}]};a.setOption(t)},Z=()=>{if(!z.value)return;const a=e(z.value),t={tooltip:{trigger:"axis"},legend:{data:["通讯时长"]},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:R.value.map(e=>e.date)},yAxis:{type:"value",axisLabel:{formatter:"{value}h"}},series:[{name:"通讯时长",type:"bar",barWidth:"60%",data:R.value.map(e=>e.duration)}]};a.setOption(t)};return(e,a)=>{const t=c("a-statistic"),l=c("a-card"),i=c("a-col"),r=c("a-row"),D=c("a-select-option"),I=c("a-select"),R=c("a-form-item"),X=c("a-input"),q=c("a-range-picker"),P=c("a-button"),Z=c("a-space"),ee=c("a-form"),ae=c("a-tag"),te=c("a-popconfirm"),le=c("a-table"),ie=c("a-spin"),re=c("a-descriptions-item"),ne=c("a-descriptions"),se=c("a-modal");return n(),s("div",_,[a[30]||(a[30]=u("div",{class:"page-header"},[u("h1",null,"通讯记录"),u("p",null,"管理所有通讯活动的记录，支持搜索、筛选和统计分析")],-1)),o(r,{gutter:16,class:"status-overview"},{default:d(()=>[o(i,{span:6},{default:d(()=>[o(l,null,{default:d(()=>[o(t,{title:"今日通讯",value:g.todayCommunications,"value-style":{color:"#3f8600"}},null,8,["value"])]),_:1})]),_:1}),o(i,{span:6},{default:d(()=>[o(l,null,{default:d(()=>[o(t,{title:"成功通讯",value:g.successCommunications,"value-style":{color:"#1890ff"}},null,8,["value"])]),_:1})]),_:1}),o(i,{span:6},{default:d(()=>[o(l,null,{default:d(()=>[o(t,{title:"失败通讯",value:g.failedCommunications,"value-style":{color:"#fa8c16"}},null,8,["value"])]),_:1})]),_:1}),o(i,{span:6},{default:d(()=>[o(l,null,{default:d(()=>[o(t,{title:"总通讯时长",value:g.totalDuration,"value-style":{color:"#722ed1"}},{suffix:d(()=>[...a[5]||(a[5]=[v("小时",-1)])]),_:1},8,["value"])]),_:1})]),_:1})]),_:1}),o(r,{gutter:16,class:"status-overview"},{default:d(()=>[o(i,{span:6},{default:d(()=>[o(l,null,{default:d(()=>[o(t,{title:"平均通讯时长",value:g.avgDuration,"value-style":{color:"#13c2c2"}},{suffix:d(()=>[...a[6]||(a[6]=[v("分钟",-1)])]),_:1},8,["value"])]),_:1})]),_:1}),o(i,{span:6},{default:d(()=>[o(l,null,{default:d(()=>[o(t,{title:"通讯成功率",value:g.successRate,"value-style":{color:"#52c41a"}},{suffix:d(()=>[...a[7]||(a[7]=[v("%",-1)])]),_:1},8,["value"])]),_:1})]),_:1}),o(i,{span:6},{default:d(()=>[o(l,null,{default:d(()=>[o(t,{title:"平均延迟",value:g.avgLatency,"value-style":{color:"#eb2f96"}},{suffix:d(()=>[...a[8]||(a[8]=[v("ms",-1)])]),_:1},8,["value"])]),_:1})]),_:1}),o(i,{span:6},{default:d(()=>[o(l,null,{default:d(()=>[o(t,{title:"活跃设备数",value:g.activeDevices,"value-style":{color:"#fa541c"}},{suffix:d(()=>[...a[9]||(a[9]=[v("台",-1)])]),_:1},8,["value"])]),_:1})]),_:1})]),_:1}),o(l,{title:"搜索筛选",class:"search-filter"},{default:d(()=>[o(ee,{layout:"inline",model:w},{default:d(()=>[o(R,{label:"通讯类型"},{default:d(()=>[o(I,{value:w.communicationType,"onUpdate:value":a[0]||(a[0]=e=>w.communicationType=e),placeholder:"选择通讯类型",style:{width:"150px"},"allow-clear":""},{default:d(()=>[o(D,{value:"voice"},{default:d(()=>[...a[10]||(a[10]=[v("语音通话",-1)])]),_:1}),o(D,{value:"video"},{default:d(()=>[...a[11]||(a[11]=[v("视频通话",-1)])]),_:1}),o(D,{value:"data"},{default:d(()=>[...a[12]||(a[12]=[v("数据传输",-1)])]),_:1}),o(D,{value:"broadcast"},{default:d(()=>[...a[13]||(a[13]=[v("广播",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),o(R,{label:"通讯状态"},{default:d(()=>[o(I,{value:w.status,"onUpdate:value":a[1]||(a[1]=e=>w.status=e),placeholder:"选择通讯状态",style:{width:"150px"},"allow-clear":""},{default:d(()=>[o(D,{value:"success"},{default:d(()=>[...a[14]||(a[14]=[v("成功",-1)])]),_:1}),o(D,{value:"failed"},{default:d(()=>[...a[15]||(a[15]=[v("失败",-1)])]),_:1}),o(D,{value:"missed"},{default:d(()=>[...a[16]||(a[16]=[v("未接",-1)])]),_:1}),o(D,{value:"cancelled"},{default:d(()=>[...a[17]||(a[17]=[v("已取消",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),o(R,{label:"设备名称"},{default:d(()=>[o(X,{value:w.deviceName,"onUpdate:value":a[2]||(a[2]=e=>w.deviceName=e),placeholder:"输入设备名称",style:{width:"200px"},"allow-clear":""},null,8,["value"])]),_:1}),o(R,{label:"时间范围"},{default:d(()=>[o(q,{value:w.timeRange,"onUpdate:value":a[3]||(a[3]=e=>w.timeRange=e),"show-time":"",format:"YYYY-MM-DD HH:mm:ss",placeholder:"['开始时间', '结束时间']"},null,8,["value"])]),_:1}),o(R,null,{default:d(()=>[o(Z,null,{default:d(()=>[o(P,{type:"primary",onClick:B},{default:d(()=>[...a[18]||(a[18]=[v("搜索",-1)])]),_:1}),o(P,{onClick:E},{default:d(()=>[...a[19]||(a[19]=[v("重置",-1)])]),_:1}),o(P,{onClick:F},{default:d(()=>[...a[20]||(a[20]=[v("导出",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),o(l,{title:"通讯记录",class:"records-list"},{default:d(()=>[u("div",h,[o(Z,null,{default:d(()=>[o(P,{type:"primary",onClick:K},{default:d(()=>[...a[21]||(a[21]=[v("刷新",-1)])]),_:1}),o(P,{onClick:Q,disabled:!W.value},{default:d(()=>[...a[22]||(a[22]=[v("批量删除",-1)])]),_:1},8,["disabled"]),W.value?(n(),s("span",k,"已选择 "+p(M.value.length)+" 项",1)):m("",!0)]),_:1})]),o(le,{columns:S,"data-source":O.value,pagination:{pageSize:15,showSizeChanger:!0,showQuickJumper:!0},loading:L.value,"row-selection":{selectedRowKeys:M.value,onChange:V},"row-key":"id"},{bodyCell:d(({column:e,record:t})=>{return["status"===e.key?(n(),f(ae,{key:0,color:(r=t.status,{success:"green",failed:"red",missed:"orange",cancelled:"blue"}[r]||"default")},{default:d(()=>[v(p(Y(t.status)),1)]),_:2},1032,["color"])):"type"===e.key?(n(),f(ae,{key:1,color:(i=t.type,{voice:"blue",video:"green",data:"orange",broadcast:"purple"}[i]||"default")},{default:d(()=>[v(p(G(t.type)),1)]),_:2},1032,["color"])):"priority"===e.key?(n(),f(ae,{key:2,color:(l=t.priority,{low:"blue",normal:"green",high:"orange",urgent:"red"}[l]||"default")},{default:d(()=>[v(p(H(t.priority)),1)]),_:2},1032,["color"])):"duration"===e.key?(n(),s("span",b,p(J(t.duration)),1)):"action"===e.key?(n(),f(Z,{key:4},{default:d(()=>[o(P,{type:"link",size:"small",onClick:e=>(e=>{N.value=e,U.value=!0})(t)},{default:d(()=>[...a[23]||(a[23]=[v(" 查看详情 ",-1)])]),_:2},1032,["onClick"]),o(P,{type:"link",size:"small",onClick:e=>(e=>{y.info(`开始回放通讯记录: ${e.id}`)})(t)},{default:d(()=>[...a[24]||(a[24]=[v(" 回放 ",-1)])]),_:2},1032,["onClick"]),o(P,{type:"link",size:"small",onClick:e=>(e=>{y.info(`编辑通讯记录: ${e.id}`)})(t)},{default:d(()=>[...a[25]||(a[25]=[v(" 编辑 ",-1)])]),_:2},1032,["onClick"]),o(te,{title:"确定要删除这条记录吗？",onConfirm:e=>(e=>{y.success(`通讯记录 ${e.id} 已删除`)})(t)},{default:d(()=>[o(P,{type:"link",size:"small",danger:""},{default:d(()=>[...a[26]||(a[26]=[v("删除",-1)])]),_:1})]),_:2},1032,["onConfirm"])]),_:2},1024)):m("",!0)];var l,i,r}),_:1},8,["data-source","loading","row-selection"])]),_:1}),o(l,{title:"统计分析",class:"statistics-analysis"},{default:d(()=>[o(r,{gutter:16},{default:d(()=>[o(i,{span:12},{default:d(()=>[u("div",x,[a[27]||(a[27]=u("div",{class:"chart-title"},"通讯类型分布",-1)),o(ie,{spinning:$.value,tip:"图表加载中..."},{default:d(()=>[u("div",{ref_key:"typeDistributionChartRef",ref:A,class:"chart-wrapper"},null,512)]),_:1},8,["spinning"])])]),_:1}),o(i,{span:12},{default:d(()=>[u("div",C,[a[28]||(a[28]=u("div",{class:"chart-title"},"通讯状态统计",-1)),o(ie,{spinning:$.value,tip:"图表加载中..."},{default:d(()=>[u("div",{ref_key:"statusDistributionChartRef",ref:j,class:"chart-wrapper"},null,512)]),_:1},8,["spinning"])])]),_:1})]),_:1}),o(r,{gutter:16,style:{"margin-top":"24px"}},{default:d(()=>[o(i,{span:24},{default:d(()=>[u("div",T,[a[29]||(a[29]=u("div",{class:"chart-title"},"通讯时长趋势",-1)),o(ie,{spinning:$.value,tip:"图表加载中..."},{default:d(()=>[u("div",{ref_key:"durationTrendChartRef",ref:z,class:"chart-wrapper"},null,512)]),_:1},8,["spinning"])])]),_:1})]),_:1})]),_:1}),o(se,{open:U.value,"onUpdate:open":a[4]||(a[4]=e=>U.value=e),title:"通讯记录详情",width:"700px",footer:null},{default:d(()=>[o(ne,{column:2,bordered:""},{default:d(()=>[o(re,{label:"通讯ID"},{default:d(()=>{var e;return[v(p(null==(e=N.value)?void 0:e.id),1)]}),_:1}),o(re,{label:"通讯名称"},{default:d(()=>{var e;return[v(p(null==(e=N.value)?void 0:e.name),1)]}),_:1}),o(re,{label:"通讯类型"},{default:d(()=>{var e;return[v(p(G((null==(e=N.value)?void 0:e.type)||"")),1)]}),_:1}),o(re,{label:"通讯状态"},{default:d(()=>{var e;return[v(p(Y((null==(e=N.value)?void 0:e.status)||"")),1)]}),_:1}),o(re,{label:"优先级"},{default:d(()=>{var e;return[v(p(H((null==(e=N.value)?void 0:e.priority)||"")),1)]}),_:1}),o(re,{label:"发起设备"},{default:d(()=>{var e;return[v(p(null==(e=N.value)?void 0:e.initiator),1)]}),_:1}),o(re,{label:"目标设备"},{default:d(()=>{var e;return[v(p(null==(e=N.value)?void 0:e.target),1)]}),_:1}),o(re,{label:"开始时间"},{default:d(()=>{var e;return[v(p(null==(e=N.value)?void 0:e.startTime),1)]}),_:1}),o(re,{label:"结束时间"},{default:d(()=>{var e;return[v(p(null==(e=N.value)?void 0:e.endTime),1)]}),_:1}),o(re,{label:"通讯时长"},{default:d(()=>{var e;return[v(p(J((null==(e=N.value)?void 0:e.duration)||0)),1)]}),_:1}),o(re,{label:"信号强度"},{default:d(()=>{var e;return[v(p(null==(e=N.value)?void 0:e.signalStrength)+"%",1)]}),_:1}),o(re,{label:"延迟"},{default:d(()=>{var e;return[v(p(null==(e=N.value)?void 0:e.latency)+"ms",1)]}),_:1}),o(re,{label:"丢包率"},{default:d(()=>{var e;return[v(p(null==(e=N.value)?void 0:e.packetLoss)+"%",1)]}),_:1}),o(re,{label:"备注",span:2},{default:d(()=>{var e;return[v(p((null==(e=N.value)?void 0:e.remark)||"无"),1)]}),_:1})]),_:1})]),_:1},8,["open"])])}}}),[["__scopeId","data-v-3427eb95"]]);export{w as default};
