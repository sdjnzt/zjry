# 地图配置说明

## 概述

本系统支持两种地图模式：
1. **高德地图API** - 用于全景视图页面，显示真实地图
2. **模拟地图** - 用于地理信息标注页面，完全离线运行

## 高德地图API配置（全景视图页面）

### 1. 申请API密钥
1. 访问 [高德开放平台](https://lbs.amap.com/)
2. 注册账号并登录
3. 创建应用，选择"Web端(JS API)"
4. 获取API密钥

### 2. 配置API密钥
有两种方式配置API密钥：

#### 方式一：环境变量配置（推荐）
在项目根目录创建 `.env.local` 文件：
```bash
VITE_AMAP_API_KEY=your_actual_api_key_here
```

#### 方式二：直接修改HTML文件
在 `index.html` 中修改：
```html
<script src="https://webapi.amap.com/maps?v=2.0&key=your_actual_api_key_here"></script>
```

### 3. 高德地图功能特性
- **真实地图** - 显示济宁港和梁山港的真实地理环境
- **摄像头点位** - 显示监控摄像头位置和状态
- **船舶AIS位置** - 实时显示船舶位置和航向
- **气象水文站** - 显示气象监测站位置和数据
- **雷达覆盖** - 显示雷达监控覆盖范围
- **航道边界** - 显示航道边界和深度信息
- **碰撞检测** - 智能检测船舶碰撞风险

### 4. 坐标系统
- **济宁港** - 中心坐标：116.5800°E, 35.3800°N
- **梁山港** - 中心坐标：116.6500°E, 35.3500°N
- **京杭大运河** - 济宁段航道监控

## 模拟地图配置（地理信息标注页面）

### 1. 功能特性
- **完全离线** - 不依赖外部地图服务
- **精确标注** - 支持经纬度坐标、覆盖范围、朝向角度
- **可视化布点** - 形成可视化的设备布点图
- **网格辅助** - 10x6网格线辅助精确定位
- **坐标刻度** - 显示经纬度刻度，便于坐标读取

### 2. 坐标系统
- **经纬度范围** - 经度：120.000000°-121.000000°，纬度：30.000000°-31.000000°
- **相对坐标** - 使用百分比坐标(0-100%)，适配不同屏幕尺寸
- **坐标转换** - 自动计算经纬度与相对坐标的对应关系

### 3. 设备标注
- **设备总数**：24台设备
- **区域覆盖**：港区A、港区B、港区C、航道区、锚地区
- **设备类型**：摄像头、传感器、网络设备、存储设备
- **状态显示**：在线、离线、维护中、故障

## 配置验证

### 1. 检查配置状态
系统会自动验证地图配置：
- 高德地图API密钥是否有效
- 坐标配置是否正确
- 插件配置是否完整

### 2. 常见问题解决

#### 高德地图加载失败
1. 检查API密钥是否正确
2. 确认网络连接正常
3. 检查浏览器控制台错误信息
4. 验证域名是否在高德平台白名单中

#### 模拟地图显示异常
1. 检查设备数据格式
2. 确认坐标范围是否在有效区间
3. 验证CSS样式是否正确加载

## 使用说明

### 1. 全景视图页面
- 使用高德地图API显示真实地图
- 支持图层控制（摄像头、船舶、气象、雷达）
- 提供PTZ控制、视频播放、碰撞检测等功能
- 实时更新船舶位置和气象数据

### 2. 地理信息标注页面
- 使用模拟地图，完全离线运行
- 支持精确的设备坐标标注
- 提供覆盖范围可视化和朝向角度指示
- 支持设备添加、编辑、导出等管理功能

## 技术实现

### 1. 高德地图集成
- 使用AMap JavaScript API 2.0
- 支持多种地图样式和视图模式
- 集成Scale、ToolBar、MapType等控件
- 支持自定义标记点和覆盖物

### 2. 模拟地图实现
- 基于CSS Grid和Flexbox布局
- 使用百分比坐标系统
- 支持响应式设计和交互操作
- 完全客户端渲染，无需服务器

## 更新日志

- **v1.0.0**: 实现基础地图功能
- **v1.1.0**: 添加高德地图API支持
- **v1.2.0**: 集成模拟地图功能
- **v2.0.0**: 新增精确标注功能，支持经纬度坐标、覆盖范围、朝向角度
- **v2.1.0**: 支持双地图模式，高德地图API + 模拟地图

## 技术支持

如遇到问题，请检查：
1. 浏览器控制台错误信息
2. 地图配置是否正确
3. API密钥是否有效
4. 网络连接是否正常
5. 浏览器兼容性

---

**重要提醒**：
- **全景视图页面**：需要配置高德地图API密钥才能正常显示
- **地理信息标注页面**：使用模拟地图，完全离线运行，无需配置外部服务
- 两种地图模式可以同时使用，互不影响
